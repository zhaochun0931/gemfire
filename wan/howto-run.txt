docker compose up




# create the gateway receiver first


gfb:


docker exec -it gfb-locator1 gfsh

connect

create gateway-receiver --hostname-for-senders=gfb-locator1 --start-port=2000 --end-port=3000

create gateway-receiver --hostname-for-senders=gfb-locator1,gfb-locator2 --start-port=2000 --end-port=3000


# or just run

create gateway-receiver

Cluster-200 gfsh>create gateway-receiver
  Member    | Status | Message
----------- | ------ | ----------------------------------------------------------------------------------
gfb-server1 | OK     | GatewayReceiver created on member "gfb-server1" and will listen on the port "5479"
gfb-server2 | OK     | GatewayReceiver created on member "gfb-server2" and will listen on the port "5283"
gfb-server3 | OK     | GatewayReceiver created on member "gfb-server3" and will listen on the port "5027"

Cluster configuration for group 'cluster' is updated.

Cluster-200 gfsh>










gfa:


docker exec -it gfa-locator1 gfsh

connect

create gateway-sender --id=gw1 --remote-distributed-system-id=200

list gateways



Cluster-100 gfsh>destroy gateway-sender --id=gw1 --if-exists=yes
  Member    | Status | Message
----------- | ------ | -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
gfa-server1 | ERROR  |  org.apache.geode.internal.cache.wan.GatewaySenderException: The GatewaySender SerialGatewaySender{id=gw1,remoteDsId=200,isRunning =false,isPrimary =false} could not be destroyed as it is still used by regio..
gfa-server2 | ERROR  |  org.apache.geode.internal.cache.wan.GatewaySenderException: The GatewaySender SerialGatewaySender{id=gw1,remoteDsId=200,isRunning =false,isPrimary =false} could not be destroyed as it is still used by regio..
gfa-server3 | ERROR  |  org.apache.geode.internal.cache.wan.GatewaySenderException: The GatewaySender SerialGatewaySender{id=gw1,remoteDsId=200,isRunning =false,isPrimary =false} could not be destroyed as it is still used by regio..

Did not complete waiting for GatewaySenderMBean proxy deletion

Cluster-100 gfsh>




gfsh>describe region --name=/exampleRegion
Name            : exampleRegion
Data Policy     : persistent replicate
Hosting Members : gfa-server3
                  gfa-server2
                  gfa-server1

Non-Default Attributes Shared By Hosting Members

 Type  |       Name        | Value
------ | ----------------- | --------------------
Region | data-policy       | PERSISTENT_REPLICATE
       | size              | 0
       | scope             | distributed-ack
       | gateway-sender-id | gw1


Cluster-100 gfsh>



alter region --name=/exampleRegion --gateway-sender-id



gfsh>alter region --name=/exampleRegion --gateway-sender-id
  Member    | Status | Message
----------- | ------ | ----------------------------
gfa-server1 | OK     | Region exampleRegion altered
gfa-server2 | OK     | Region exampleRegion altered
gfa-server3 | OK     | Region exampleRegion altered

Cluster configuration for group 'cluster' is updated.

Cluster-100 gfsh>describe region --name=/exampleRegion
Name            : exampleRegion
Data Policy     : persistent replicate
Hosting Members : gfa-server3
                  gfa-server2
                  gfa-server1

Non-Default Attributes Shared By Hosting Members

 Type  |    Name     | Value
------ | ----------- | --------------------
Region | data-policy | PERSISTENT_REPLICATE
       | size        | 0
       | scope       | distributed-ack


Cluster-100 gfsh>





























Cluster-100 gfsh>list gateways
GatewaySender Section

GatewaySender Id | Member | Remote Cluster Id |  Type  |        Status         | Queued Events | Receiver Location
---------------- | ------ | ----------------- | ------ | --------------------- | ------------- | -----------------
gw1              | 24f8.. | 200               | Serial | Running and Connected | 0             | 6fe91d2bf603:5479
gw1              | a917.. | 200               | Serial | Running and Connected | 0             | 6fe91d2bf603:5479
gw1              | fe8b.. | 200               | Serial | Running and Connected | 0             | 6fe91d2bf603:5479

Cluster-100 gfsh>










# create region



gfa:

create region --name=exampleRegion --type=REPLICATE_PERSISTENT --gateway-sender-id=gw1








gfb:

create region --name=exampleRegion --type=REPLICATE_PERSISTENT





# create the entry

gfa:

put --key=1 --value=hello1 --region=/exampleRegion








